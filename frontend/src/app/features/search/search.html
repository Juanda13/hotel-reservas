<mat-card>
  <h2>Buscar habitaciones</h2>

  <form (ngSubmit)="submit()" [formGroup]="form" class="form-grid">
    <mat-form-field appearance="outline">
      <mat-label>Check-in</mat-label>
      <input
        matInput
        [matDatepicker]="pickerIn"
        formControlName="checkIn"
        required
      />
      <mat-datepicker-toggle matSuffix [for]="pickerIn"></mat-datepicker-toggle>
      <mat-datepicker #pickerIn></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Check-out</mat-label>
      <input
        matInput
        [matDatepicker]="pickerOut"
        formControlName="checkOut"
        required
      />
      <mat-datepicker-toggle
        matSuffix
        [for]="pickerOut"
      ></mat-datepicker-toggle>
      <mat-datepicker #pickerOut></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Huéspedes</mat-label>
      <input matInput type="number" min="1" formControlName="guests" required />
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="form.invalid || loading()"
    >
      {{ loading() ? "Buscando..." : "Buscar" }}
    </button>
  </form>

  <p *ngIf="error()" style="color: var(--mat-sys-error)">⚠ {{ error() }}</p>
</mat-card>

<mat-card *ngIf="data()">
  <h3>Resultados</h3>
  <table
    mat-table
    [dataSource]="data()!.results"
    class="mat-elevation-z1"
    style="width: 100%"
  >
    <ng-container matColumnDef="roomId">
      <th mat-header-cell *matHeaderCellDef>ID</th>
      <td mat-cell *matCellDef="let r">{{ r.roomId }}</td>
    </ng-container>
    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef>Tipo</th>
      <td mat-cell *matCellDef="let r">{{ r.type }}</td>
    </ng-container>
    <ng-container matColumnDef="capacity">
      <th mat-header-cell *matHeaderCellDef>Capacidad</th>
      <td mat-cell *matCellDef="let r">{{ r.capacity }}</td>
    </ng-container>
    <ng-container matColumnDef="price">
      <th mat-header-cell *matHeaderCellDef>Precio</th>
      <td mat-cell *matCellDef="let r">{{ r.price | currency : "USD" }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</mat-card>
